<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Basic Workflow • SmarterScotland</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/paper/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Basic Workflow">
<meta property="og:description" content="">
<meta property="og:image" content="https://konradzdeb.github.io/SmarterScotland/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-129716792-2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129716792-2');
</script>
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SmarterScotland</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.0.9010</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/basic-workflow.html">Basic Workflow</a>
    </li>
    <li>
      <a href="../articles/support-functions.html">Support Functions</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/konradzdeb/SmarterScotland">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Basic Workflow</h1>
                        <h4 class="author">Konrad Zdeb</h4>
            
            <h4 class="date">2019-10-05</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/konradzdeb/SmarterScotland/blob/master/vignettes/basic-workflow.Rmd"><code>vignettes/basic-workflow.Rmd</code></a></small>
      <div class="hidden name"><code>basic-workflow.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>The following packages makes use of the SPARQL<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> language queries in order to query the data available through the <a href="http://statistics.gov.scot">statistics.gov.scot</a> portal<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>. In effect, the app works as a wrapper for SPARQL queries providing a suite of common functionalities relevant to how the Scottish public data is being utilises.</p>
</div>
<div id="workflow" class="section level1">
<h1 class="hasAnchor">
<a href="#workflow" class="anchor"></a>Workflow</h1>
<p>The proposed workflow looks at obtaining <em>life expectancy</em> data for the <em>Glasgow City.</em> The workflow focuses on the following steps:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Data Selection:</strong> Identification of the relevant data</li>
<li>
<strong>Geography Selection:</strong> Verifying name of geography for which we want to source data</li>
<li>
<strong>Data Sourcing:</strong> Querying <a href="http://statistics.gov.scot">statistics.gov.scot</a> SPARQL endpoint</li>
<li>
<strong>Pre-processing and Analysis:</strong> Fixing data types and removing redundant columns</li>
</ol>
<div id="data-selection" class="section level2">
<h2 class="hasAnchor">
<a href="#data-selection" class="anchor"></a>1. Data Selection</h2>
<p>The package comes with an embedded data sets containing list of data and geographies available through the <a href="http://statistics.gov.scot">statistics.gov.scot</a> endpoint. To see the list of available data sets refer to the <code><a href="https://www.rdocumentation.org/packages/utils/topics/data">data("available_data_sets")</a></code> objects. The <code>available_data_sets</code> contains <code>subject</code> column that can be used to identify relevant data, as shown below.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(<span class="st">"available_data_sets"</span>)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/subset">subset.data.frame</a></span>(<span class="dt">x =</span> available_data_sets, </a>
<a class="sourceLine" id="cb1-3" data-line-number="3">                  <span class="dt">subset =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/grep">grepl</a></span>(<span class="dt">pattern =</span> <span class="st">"expectancy"</span>, <span class="dt">x =</span> subject))</a></code></pre></div>
<table class="table">
<caption>Available Life Expectancy Data</caption>
<thead><tr class="header">
<th></th>
<th align="left">dataset_value</th>
<th align="left">subject</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>119</td>
<td align="left"><a href="http://statistics.gov.scot/data/healthy-life-expectancy" class="uri">http://statistics.gov.scot/data/healthy-life-expectancy</a></td>
<td align="left">healthy-life-expectancy</td>
</tr>
<tr class="even">
<td>120</td>
<td align="left"><a href="http://statistics.gov.scot/data/healthy-life-expectancy-deprived" class="uri">http://statistics.gov.scot/data/healthy-life-expectancy-deprived</a></td>
<td align="left">healthy-life-expectancy-deprived</td>
</tr>
<tr class="odd">
<td>155</td>
<td align="left"><a href="http://statistics.gov.scot/data/life-expectancy" class="uri">http://statistics.gov.scot/data/life-expectancy</a></td>
<td align="left">life-expectancy</td>
</tr>
</tbody>
</table>
</div>
<div id="geography" class="section level2">
<h2 class="hasAnchor">
<a href="#geography" class="anchor"></a>2. Geography</h2>
<p>The object <code><a href="https://www.rdocumentation.org/packages/utils/topics/data">data("standard_geography_code_register")</a></code> is provided to facilitate verifying existence of the geography we are interested in. Similarly, as in the previous step we can use <code><a href="https://www.rdocumentation.org/packages/base/topics/grep">grep()</a></code> to verify existence of that object in the provided data frame. For that purpose we can check the <code>value</code> column for existence of the desired string.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(<span class="st">"standard_geography_code_register"</span>)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/subset">subset.data.frame</a></span>(<span class="dt">x =</span> standard_geography_code_register,</a>
<a class="sourceLine" id="cb2-3" data-line-number="3">                  <span class="dt">subset =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/grep">grepl</a></span>(<span class="dt">pattern =</span> <span class="st">"^Glasgow City$"</span>, <span class="dt">x =</span> value))</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th></th>
<th align="left">geography</th>
<th align="left">property</th>
<th align="left">value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>15487</td>
<td align="left"><a href="http://statistics.gov.scot/id/statistical-geography/S12000016" class="uri">http://statistics.gov.scot/id/statistical-geography/S12000016</a></td>
<td align="left"><a href="http://statistics.data.gov.uk/def/statistical-geography#officialname" class="uri">http://statistics.data.gov.uk/def/statistical-geography#officialname</a></td>
<td align="left">Glasgow City</td>
</tr>
<tr class="even">
<td>16196</td>
<td align="left"><a href="http://statistics.gov.scot/id/statistical-geography/S12000049" class="uri">http://statistics.gov.scot/id/statistical-geography/S12000049</a></td>
<td align="left"><a href="http://statistics.data.gov.uk/def/statistical-geography#officialname" class="uri">http://statistics.data.gov.uk/def/statistical-geography#officialname</a></td>
<td align="left">Glasgow City</td>
</tr>
<tr class="odd">
<td>29279</td>
<td align="left"><a href="http://statistics.gov.scot/id/statistical-geography/S12000037" class="uri">http://statistics.gov.scot/id/statistical-geography/S12000037</a></td>
<td align="left"><a href="http://statistics.data.gov.uk/def/statistical-geography#officialname" class="uri">http://statistics.data.gov.uk/def/statistical-geography#officialname</a></td>
<td align="left">Glasgow City</td>
</tr>
<tr class="even">
<td>30094</td>
<td align="left"><a href="http://statistics.gov.scot/id/statistical-geography/S12000043" class="uri">http://statistics.gov.scot/id/statistical-geography/S12000043</a></td>
<td align="left"><a href="http://www.w3.org/2000/01/rdf-schema#label" class="uri">http://www.w3.org/2000/01/rdf-schema#label</a></td>
<td align="left">Glasgow City</td>
</tr>
<tr class="odd">
<td>31380</td>
<td align="left"><a href="http://statistics.gov.scot/id/statistical-geography/S37000034" class="uri">http://statistics.gov.scot/id/statistical-geography/S37000034</a></td>
<td align="left"><a href="http://statistics.data.gov.uk/def/statistical-geography#officialname" class="uri">http://statistics.data.gov.uk/def/statistical-geography#officialname</a></td>
<td align="left">Glasgow City</td>
</tr>
<tr class="even">
<td>32471</td>
<td align="left"><a href="http://statistics.gov.scot/id/statistical-geography/S12000046" class="uri">http://statistics.gov.scot/id/statistical-geography/S12000046</a></td>
<td align="left"><a href="http://www.w3.org/2000/01/rdf-schema#label" class="uri">http://www.w3.org/2000/01/rdf-schema#label</a></td>
<td align="left">Glasgow City</td>
</tr>
<tr class="odd">
<td>36694</td>
<td align="left"><a href="http://statistics.gov.scot/id/statistical-geography/S37000015" class="uri">http://statistics.gov.scot/id/statistical-geography/S37000015</a></td>
<td align="left"><a href="http://www.w3.org/2000/01/rdf-schema#label" class="uri">http://www.w3.org/2000/01/rdf-schema#label</a></td>
<td align="left">Glasgow City</td>
</tr>
</tbody>
</table>
</div>
<div id="data-sourcing" class="section level2">
<h2 class="hasAnchor">
<a href="#data-sourcing" class="anchor"></a>3. Data Sourcing</h2>
<p>Most of the data sourcing work is done through <code><a href="../reference/get_geography_data.html">get_geography_data()</a></code> function. Following from the example below the function can be applied as follows</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">dta_Glasgow_Life_Expectancy &lt;-<span class="st"> </span><span class="kw"><a href="../reference/get_geography_data.html">get_geography_data</a></span>(<span class="dt">data_set =</span> <span class="st">"healthy-life-expectancy"</span>,</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">                                                  <span class="dt">geography =</span> <span class="st">"Glasgow City"</span>,</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">                                                  <span class="dt">measure =</span> <span class="st">"count"</span>,</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">                                                  <span class="dt">pre_process_results =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="co">#&gt; Geography 'Glasgow City' matched multiple URIs</span></a></code></pre></div>
</div>
<div id="pre-processing-and-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#pre-processing-and-analysis" class="anchor"></a>4. Pre-processing and Analysis</h2>
<p>The pre-processing of the results already took place and was achieved by passing <code>pre_process_results = TRUE</code> to <code><a href="../reference/get_geography_data.html">get_geography_data()</a></code> function. The results can be also pre-processed independently by calling <code><a href="../reference/pre_process_data.html">pre_process_data()</a></code> on a returned object. The provided object is lends itself well for analysis.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/message">suppressPackageStartupMessages</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(tidyverse))</a>
<a class="sourceLine" id="cb4-2" data-line-number="2">dta_Glasgow_Life_Expectancy <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="st">  </span><span class="kw">rename</span>(<span class="st">"exp"</span> =<span class="st"> </span>count) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/filter">filter</a></span>(age <span class="op">%in%</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"1-4"</span>, <span class="st">"25-29"</span>, <span class="st">"40-44"</span>, <span class="st">"80-84"</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> exp, <span class="dt">x =</span> age, <span class="dt">fill =</span> sex)) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">"Age"</span>,</a>
<a class="sourceLine" id="cb4-7" data-line-number="7">       <span class="dt">y =</span> <span class="st">"Healthy Life Expectancy"</span>,</a>
<a class="sourceLine" id="cb4-8" data-line-number="8">       <span class="dt">title =</span> <span class="st">"Healthy Life Expectancy"</span>,</a>
<a class="sourceLine" id="cb4-9" data-line-number="9">       <span class="dt">subtitle =</span> <span class="st">"Glasgow City; arbitrary age brackets"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-10" data-line-number="10"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">"identity"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-11" data-line-number="11"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="dt">facets =</span> . <span class="op">~</span><span class="st"> </span>sex) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-12" data-line-number="12"><span class="st">  </span><span class="kw">theme_light</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb4-13" data-line-number="13"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">hjust =</span> <span class="dv">1</span>, <span class="dt">vjust =</span> <span class="fl">0.5</span>),</a>
<a class="sourceLine" id="cb4-14" data-line-number="14">        <span class="dt">legend.position =</span> <span class="st">"bottom"</span>)</a></code></pre></div>
<p><img src="basic-workflow_files/figure-html/chart_life_expectancy-1.png" width="700"></p>
</div>
</div>
<div id="conclusion" class="section level1">
<h1 class="hasAnchor">
<a href="#conclusion" class="anchor"></a>Conclusion</h1>
<p>For the sake of efficiency the objects <code><a href="https://www.rdocumentation.org/packages/utils/topics/data">data("available_data_sets")</a></code> and <code><a href="https://www.rdocumentation.org/packages/utils/topics/data">data("standard_geography_code_register")</a></code> are provided in the package. Those objects are not updated too frequently and providing them as statics data sets makes sense from the efficiency perspective. It is however possible to source live the mentioned objects. This is discussed in <code><a href="../articles/support-functions.html">vignette("support-functions")</a></code>.</p>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>Detailed information on the SPARQL is available through <a href="https://www.w3.org/TR/rdf-sparql-query/">W3C pages</a>.<a href="#fnref1" class="footnote-back">↩</a></p></li>
<li id="fn2"><p>The implementation follows part of the <em>Open Data Strategy</em> implemented by the Scottish Government that can be accessed through the <a href="http://www.gov.scot/Topics/Economy/digital/digitalservices/datamanagement/OpenData">Scottish Government pages</a>.<a href="#fnref2" class="footnote-back">↩</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li>
<a href="#workflow">Workflow</a><ul class="nav nav-pills nav-stacked">
<li><a href="#data-selection">1. Data Selection</a></li>
      <li><a href="#geography">2. Geography</a></li>
      <li><a href="#data-sourcing">3. Data Sourcing</a></li>
      <li><a href="#pre-processing-and-analysis">4. Pre-processing and Analysis</a></li>
      </ul>
</li>
      <li><a href="#conclusion">Conclusion</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Konrad Zdeb.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
